<html>
	<head>
		<link rel="stylesheet" href="https://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
		<script type="text/javascript" src="https://code.jquery.com/jquery.min.js"></script>
		<script type="text/javascript" src="https://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
	
		<!-- CSS -->
		<style type="text/css">
		.square {
		    width: 80px;
		    height: 80px;
		    line-height: 80px;
		    border: 1px solid black;
		    margin-bottom: 5px;
		    margin-left: 5px;
		    text-align: center;
		    float: left;
		    background-color: lightblue;
		    cursor: pointer;
		    font-weight: bold;
		}

		.squaredotted {
		    width: 80px;
		    height: 80px;
		    line-height: 80px;
		    border: 1px dotted gray;
		    margin-bottom: 50px;
		    margin-left: 50px;
		    text-align: center;
		    float: left;
		    color: gray;
		    background-color: lightgray;
		}
		</style>
		<style type="text/css">
		.name {
		    width: 70px;
		    margin-top: 5px;
		    margin-bottom: 5px;
		}
		.weigth {
		    width: 70px;
		    margin-top: 5px;
		    margin-bottom: 5px;
		}		
		</style>

		<style type="text/css">
		.name {
		    width: 70px;
		    margin-top: 5px;
		    margin-bottom: 5px;
		}
		.weigth {
		    width: 70px;
		    margin-top: 5px;
		    margin-bottom: 5px;
		}		
		</style>
		<!-- Javascript -->
		<script>
		$(function () {
			$(".square").draggable({
				snap: ".squaredotted",
				snapMode: "inner",
				stop: function(event, ui) { 
					/* Get the possible snap targets: */
					var snapped = $(this).data('ui-draggable').snapElements;

					/* Pull out only the snap targets that are "snapping": */
					var snappedTo = $.map(snapped, function(element) {
					    return element.snapping ? element.item : null;
					});

					/* Display the results: */
					var result = [];
					$.each(snappedTo, function(idx, item) {
					    result.push($(item).text());
					});
               console.log("current_number: " + $(this).data("current_number"));
               if(result.length == 0){
                  if($(this).data("current_number") == "1" || $(this).data("current_number") == "3" || $(this).data("current_number") == "5" || $(this).data("current_number") == "7" || $(this).data("current_number") == "9" || $(this).data("current_number") == "11") {
                     document.getElementById("leftWeight").value = parseFloat(document.getElementById("leftWeight").value) - parseFloat($(this).find("input")[1].value);
                     console.log("1");
                  }
                  if($(this).data("current_number") == "2" || $(this).data("current_number") == "4" || $(this).data("current_number") == "6" || $(this).data("current_number") == "8" || $(this).data("current_number") == "10" || $(this).data("current_number") == "12") {
                     document.getElementById("rightWeight").value = parseFloat(document.getElementById("rightWeight").value) - parseFloat($(this).find("input")[1].value);
                     console.log("2");
                  }
                  $(this).data("current_number", 0);
               }else if (result.length == 1) {
                  if($(this).data("current_number") == undefined || $(this).data("current_number") == 0) {
                     if(result[0] == "1" || result[0] == "3" || result[0] == "5" || result[0] == "7" || result[0] == "9" || result[0] == "11") {
                        document.getElementById("leftWeight").value = parseFloat(document.getElementById("leftWeight").value) + parseFloat($(this).find("input")[1].value);
                        console.log("3");
                     }
                     if(result[0] == "2" || result[0] == "4" || result[0] == "6" || result[0] == "8" || result[0] == "10" || result[0] == "12") {
                        document.getElementById("rightWeight").value = parseFloat(document.getElementById("rightWeight").value) + parseFloat($(this).find("input")[1].value);
                        console.log("4");
                     }
                  }
               }
               $(this).data("current_number", result);
               $("#results").html("Snapped to: " + (result === '' ? "Nothing!" : result));
            }
         });
		});
      function snapToMiddle(dragger, target){
         var topMove = target.position().top - dragger.data('position').top + (target.outerHeight(true) - dragger.outerHeight(true)) / 2;
         var leftMove= target.position().left - dragger.data('position').left + (target.outerWidth(true) - dragger.outerWidth(true)) / 2;
         dragger.animate({top:topMove,left:leftMove},{duration:600,easing:'easeOutBack'});
      }
      $('.spaces').find('div').droppable({
         drop:function(event, ui){
             snapToMiddle(ui.draggable,$(this));
         }
     });

		</script>
	</head>
	<body>
		<!-- HTML -->
		<div style="float:left">
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div style="clear:both"></div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div style="clear:both"></div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		    <div class="square">
		      <input class="name" value="郭佬"></input>
		      <input type="number" class="weigth" value="80"></input>
		    </div>
		</div>
		<div class="spaces" style="float:left;margin-left:50px;">
		    <div class="squaredotted">1</div>
		    <div class="squaredotted">2</div>
		    <div style="clear:both"></div>
		    <div class="squaredotted">3</div>
		    <div class="squaredotted">4</div>
		    <div style="clear:both"></div>
		    <div class="squaredotted">5</div>
		    <div class="squaredotted">6</div>
		    <div style="clear:both"></div>
		    <div class="squaredotted">7</div>
		    <div class="squaredotted">8</div>
		    <div style="clear:both"></div>
		    <div class="squaredotted">9</div>
		    <div class="squaredotted">10</div>
		    <div style="clear:both"></div>
		    <div class="squaredotted">11</div>
		    <div class="squaredotted">12</div>
		    <div style="clear:both"></div>
		    <input id="leftWeight" readonly="readonly" style="margin-left: 50px; width: 80px" type="number" value=0></input>
		    <input id="rightWeight" readonly="readonly" style="margin-left: 50px; width: 80px" type="number" value=0></input>
		</div>
		<div id="results">qwdqwd</div>
	</body>
</html>
